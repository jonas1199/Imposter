<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Imposter – Das Wortspiel</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }

    body{
      font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
      min-height:100vh; padding:20px; color:#333;
      cursor:default; user-select:none; -webkit-user-select:none; -moz-user-select:none; -ms-user-select:none;
    }

    button, .clickable { cursor:pointer; }
    input, select, textarea { cursor:text; }

    /* Texte bekommen I-Beam-Cursor, Auswahl bleibt global gesperrt außer .selectable */
    h1,h2,h3,h4,h5,h6,p,li,label,strong,em,small,
    .subtitle,.game-info,.footer,.player-name,.message,.player-list li { cursor:text; }
    button,.clickable{ cursor:pointer!important; }

    /* Nur hier darf markiert/kopiert werden */
    .selectable{
      user-select:text!important; -webkit-user-select:text!important; -moz-user-select:text!important; -ms-user-select:text!important;
      cursor:text;
    }
    .copyable{ border-bottom:1px dotted rgba(0,0,0,.25); }
    .copyable:hover{ border-bottom-color:rgba(0,0,0,.45); }

    .container{
      max-width:800px; margin:0 auto; background:#fff; border-radius:20px;
      box-shadow:0 20px 40px rgba(0,0,0,.1); overflow:hidden; animation:fadeIn .5s ease-in;
    }
    @keyframes fadeIn{ from{opacity:0; transform:translateY(20px);} to{opacity:1; transform:translateY(0);} }

    .card{ padding:30px; }

    h1{ text-align:center; color:#764ba2; margin-bottom:10px; font-size:2.5em; text-shadow:2px 2px 4px rgba(0,0,0,.1); }
    .subtitle{ text-align:center; color:#666; margin-bottom:30px; font-size:1.1em; }

    .mode-select{ display:grid; grid-template-columns:1fr 1fr; gap:20px; margin:30px 0; }
    .mode-option{
      background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%); color:#495057; padding:25px; border-radius:15px;
      text-align:center; cursor:pointer; transition:all .3s ease; border:3px solid transparent; position:relative; overflow:hidden;
      user-select:none; -webkit-user-select:none; -moz-user-select:none; -ms-user-select:none;
    }
    .mode-option::before{
      content:''; position:absolute; top:0; left:-100%; width:100%; height:100%;
      background:linear-gradient(90deg,transparent,rgba(255,255,255,.4),transparent); transition:left .5s;
    }
    .mode-option:hover::before{ left:100%; }
    .mode-option:hover{ transform:translateY(-5px); box-shadow:0 15px 30px rgba(0,0,0,.2); }

    .mode-option.selected{
      border-color:#764ba2; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
      color:#fff; transform:scale(1.05); box-shadow:0 20px 40px rgba(102,126,234,.4);
    }
    .mode-option.selected.local{
      border-color:#28a745; background:linear-gradient(135deg,#51cf66 0%,#28a745 100%); box-shadow:0 20px 40px rgba(40,167,69,.4);
    }
    .mode-option.selected.single{
      border-color:#0ca678; background:linear-gradient(135deg,#63e6be 0%,#0ca678 100%); box-shadow:0 20px 40px rgba(12,166,120,.35);
    }

    .mode-option h3{ font-size:1.4em; margin-bottom:10px; }

    .input-group{ margin:20px 0; }

    .join-section{
      background:linear-gradient(135deg,#fff3cd 0%,#ffecb5 100%); padding:20px; border-radius:15px; margin:20px 0; border-left:5px solid #ffc107;
    }

    input,select,button{
      width:100%; padding:15px; border:2px solid #e1e5e9; border-radius:10px; font-size:16px; margin:5px 0; transition:all .3s ease;
    }
    input:focus,select:focus{ border-color:#667eea; box-shadow:0 0 0 3px rgba(102,126,234,.1); outline:none; }
    button{
      background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:#fff; border:none; cursor:pointer; font-weight:bold; transition:all .3s ease;
    }
    button:hover{ transform:translateY(-2px); box-shadow:0 10px 20px rgba(0,0,0,.2); }
    button.secondary{ background:linear-gradient(135deg,#868e96 0%,#495057 100%); }
    button.danger{ background:linear-gradient(135deg,#fa5252 0%,#e03131 100%); }
    .hidden{ display:none!important; }

    .player-list{ list-style:none; margin:20px 0; }
    .player-list li{
      padding:15px; background:#f8f9fa; margin:10px 0; border-radius:10px; display:flex; align-items:center;
      animation:slideIn .3s ease; transition:all .3s ease;
    }
    @keyframes slideIn{ from{opacity:0; transform:translateX(-20px);} to{opacity:1; transform:translateX(0);} }

    /* Host-Badge */
    .host-badge{
      display:inline-flex; align-items:center; gap:6px; padding:2px 10px; margin-left:10px; border-radius:999px;
      background:linear-gradient(135deg,#fff0c2,#ffd86b); color:#7a5900; font-weight:700; font-size:.85em;
      box-shadow:0 2px 8px rgba(255,215,0,.35); border:1px solid rgba(122,89,0,.25); vertical-align:middle;
    }
    .host-badge .crown{ font-size:1rem; line-height:1; }

    .player-list li.host{
      background:linear-gradient(135deg,#fff8e1 0%,#ffeaa7 100%); border-left:5px solid #f4c430; box-shadow:0 8px 24px rgba(244,196,48,.25);
    }
    .player-list li.host:hover{ box-shadow:0 10px 28px rgba(244,196,48,.33); }

    /* Kacheln/Buttons nicht markierbar */
    button,.mode-option,.mode-option *, .copy-btn, button *{
      cursor:pointer!important; user-select:none; -webkit-user-select:none; -moz-user-select:none; -ms-user-select:none;
    }

    /* Copy-Button neben Raumcode */
    .copy-btn{
      display:inline-flex; align-items:center; justify-content:center; width:28px; height:28px; margin-left:6px; border:0; border-radius:8px;
      background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%); box-shadow:0 2px 8px rgba(0,0,0,.08);
      transition:transform .12s ease, box-shadow .2s ease, background .2s ease; vertical-align:middle; color:#343a40;
    }
    .copy-btn svg{ width:18px; height:18px; display:block; }
    .copy-btn .icon-check{ display:none; }
    .copy-btn.copied .icon-copy{ display:none; }
    .copy-btn.copied .icon-check{ display:block; }
    .copy-btn.copied{ color:#2b8a3e; background:linear-gradient(135deg,#d4edda 0%,#c3e6cb 100%); }
    .copy-btn.copied svg.icon-check path{ stroke:currentColor; }
    .copy-btn:hover{
      transform:translateY(-1px); box-shadow:0 4px 12px rgba(0,0,0,.12);
      background:linear-gradient(135deg,#ffffff 0%,#f1f3f5 100%);
    }

    #roomCode.highlight{ background:transparent; }
    #roomCode.highlight{ background:rgba(255,230,0,.25); transition:background .6s ease; }

    .player-list li.bot{ background:#e3f2fd; color:#1971c2; }
    .player-list li:hover{ transform:translateX(5px); box-shadow:0 5px 15px rgba(0,0,0,.1); }
    .player-icon{ margin-right:10px; font-size:1.2em; }

    .game-info{
      background:linear-gradient(135deg,#fff3cd 0%,#ffecb5 100%); padding:20px; border-radius:15px; margin:20px 0; text-align:center; border-left:5px solid #ffc107;
    }

    .role-display{
      background:linear-gradient(135deg,#d4edda 0%,#c3e6cb 100%); padding:25px; border-radius:15px; margin:20px 0; text-align:center; border-left:5px solid #28a745;
    }

    .secret-reveal{
      position:fixed; top:0; left:0; width:100%; height:100%;
      background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
      display:flex; flex-direction:column; justify-content:center; align-items:center; z-index:1001;
      color:#fff; padding:30px; text-align:center; transform:translateY(100%); transition:transform .5s cubic-bezier(.4,0,.2,1);
    }
    .secret-reveal.active{ transform:translateY(0); }
    .secret-reveal h2{ font-size:2.2em; margin-bottom:14px; text-shadow:2px 2px 4px rgba(0,0,0,.3); }
    .secret-word{ font-size:3.2em; font-weight:800; margin:18px 0; text-shadow:3px 3px 6px rgba(0,0,0,.5); }
    .hold-instruction{ font-size:1.1em; margin-top:20px; opacity:.9; }

    .voting-options{ display:grid; grid-template-columns:1fr 1fr; gap:15px; margin:20px 0; }
    .vote-option{
      background:#f8f9fa; padding:20px; border-radius:10px; text-align:center; border:2px solid transparent; transition:all .3s ease;
    }
    .vote-option:hover{ background:#e9ecef; border-color:#667eea; transform:translateY(-2px); }

    .game-result{ text-align:center; padding:30px; }
    .result-win{ background:linear-gradient(135deg,#d4edda 0%,#c3e6cb 100%); color:#155724; border-radius:15px; margin:20px 0; }
    .result-lose{ background:linear-gradient(135deg,#f8d7da 0%,#f1b0b7 100%); color:#721c24; border-radius:15px; margin:20px 0; }
    .result-icon{ font-size:4em; margin-bottom:20px; }

    .countdown{
      position:fixed; inset:0; background:rgba(0,0,0,.8); display:flex; justify-content:center; align-items:center;
      z-index:1000; color:#fff; font-size:8em; font-weight:bold;
    }

    .confirmation-dialog{
      position:fixed; inset:0; background:rgba(0,0,0,.8); display:flex; justify-content:center; align-items:center; z-index:2000;
    }
    .confirmation-content{
      background:#fff; padding:30px; border-radius:20px; text-align:center; max-width:400px; margin:20px;
    }
    .confirmation-buttons{ display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-top:20px; }

    .admin-panel{
      background:linear-gradient(135deg,#fff3cd 0%,#ffecb5 100%); padding:20px; border-radius:15px; margin:20px 0; border-left:5px solid #ffc107; text-align:center;
    }

    .footer{ text-align:center; margin-top:30px; color:#666; font-size:.9em; }

    /* Ein-Gerät Setup */
    .sd-list{ list-style:none; margin:10px 0; padding:0; }
    .sd-list li{
      display:flex; align-items:center; justify-content:space-between; background:#f8f9fa; margin:8px 0; padding:10px 12px; border-radius:10px;
    }
    .sd-list li .nm{ font-weight:600; }
    .sd-list li button{ width:auto; padding:8px 10px; margin-left:10px; }

    @media (max-width:768px){
      .mode-select{ grid-template-columns:1fr; }
      .voting-options{ grid-template-columns:1fr; }
      .secret-word{ font-size:2.5em; }
      .countdown{ font-size:5em; }
      .confirmation-buttons{ grid-template-columns:1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Startbildschirm -->
    <div id="start" class="card">
      <h1>🎭 Imposter</h1>
      <div class="subtitle">Das spannende Wortspiel mit Verstecktem</div>

      <div class="mode-select">
        <div class="mode-option local" onclick="selectMode('local', event)">
          <h3>🌐 Online-Lobby</h3>
          <p>Mit Freunden über Codes verbinden (mehrere Geräte)</p>
        </div>
        <div class="mode-option single" onclick="selectMode('single', event)">
  <h3>📱 Spiel auf einem Gerät</h3>
  <p>Namen eingeben, Gerät weitergeben, Rollen nacheinander zeigen</p>
</div>
      </div>

<!-- Ein-Gerät: Namen erfassen (IDs passend zur client.js) -->
<div id="sd-setup" class="hidden">
  <h3>Spielernamen (je Zeile ein Name)</h3>
  <div class="input-group">
    <textarea id="singleNames" rows="6" placeholder="z.B.&#10;Anna&#10;Ben&#10;Chris"></textarea>
  </div>
  <button id="startSingle" class="secondary">Spiel starten (ein Gerät)</button>
</div>



      <!-- Online: Name + Raum erstellen -->
      <div class="input-group">
        <input id="name" placeholder="Dein Name (Online-Lobby)" />
        <button id="createRoom">Raum erstellen</button>
      </div>

      <!-- Online: Raum beitreten -->
      <div id="joinBlock" class="join-section">
        <h3>🔗 Raum beitreten</h3>
        <input id="joinCode" placeholder="Raumcode eingeben" />
        <button id="joinRoom" class="secondary">Raum beitreten</button>
      </div>
    </div>

    <!-- Lobby (Online-Modus) -->
    <div id="lobby" class="card hidden">
      <h2>Lobby</h2>
      <div class="game-info">
        <strong>Raum:</strong>
        <span id="roomCode" class="selectable copyable" title="Zum Kopieren markieren"></span>
        <button id="copyRoomCode" class="copy-btn" aria-label="Raumcode kopieren" title="Raumcode kopieren">
          <!-- Icon: Copy -->
          <svg class="icon-copy" viewBox="0 0 24 24" aria-hidden="true">
            <rect x="5" y="5" width="10" height="10" rx="1.5" fill="none" stroke="currentColor" stroke-width="2"></rect>
            <rect x="9" y="9" width="10" height="10" rx="1.5" fill="none" stroke="currentColor" stroke-width="2"></rect>
          </svg>
          <!-- Icon: Check -->
          <svg class="icon-check" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M20 6L9 17l-5-5" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
        </button>
        |
        <strong>Modus:</strong> <span id="gameMode"></span>
        <span id="loading" class="loading-dots hidden">Warte auf Spieler</span>
      </div>

      <div>Spieler (<span id="playerCount">0</span>/<span id="maxPlayers">8</span>):</div>
      <ul id="players" class="player-list"></ul>

      <button id="startGame">Spiel starten</button>
      <button class="danger" onclick="showConfirmation()">❌ Raum verlassen</button>
    </div>

    <!-- Spielbereich -->
    <div id="game" class="card hidden">
      <button class="danger" onclick="showConfirmation()" style="margin-bottom:20px;">❌ Spiel verlassen</button>


      <div id="sd-flow" class="game-info hidden">
  <h3>📱 Weitergeben</h3>
  <p>Nächster Spieler: <strong id="sd-current-name">–</strong></p>
  <button id="passDevice" style="margin-top:10px;">Weitergeben ▶</button>
</div>


      <div class="role-display">
        <h2>Deine Rolle wird geheim gehalten!</h2>
        <p>Halte den Bildschirm gedrückt, um deine Rolle und dein Wort zu enthüllen</p>
        <div class="hold-area" style="padding:40px; margin:20px 0; background:#f8f9fa; border-radius:15px; text-align:center; border:3px dashed #667eea;">
          <h3 style="color:#667eea; margin-bottom:20px;">👆 Hier gedrückt halten</h3>
          <p style="color:#666; font-size:.9em;">Halte deinen Finger/Daumen auf diesem Bereich, um dein Geheimnis zu enthüllen</p>
        </div>
      </div>

      <!-- Admin Panel (nur Online) -->
      <div id="adminPanel" class="admin-panel hidden">
        <h3>👑 Admin-Bereich</h3>
        <p>Du bist der Spielleiter und kannst die nächste Runde starten</p>
        <button onclick="nextRound()" style="margin-top:10px;">🔄 Nächste Runde starten</button>
      </div>

      <!-- Abstimmungsbereich (Online) -->
      <div id="voting-section" class="hidden">
        <div class="game-info">
          <h3>🗳️ Wer ist der Imposter?</h3>
          <p>Stimme für den Spieler, von dem du denkst, dass er der Imposter ist!</p>
        </div>
        <div id="voting-options" class="voting-options"></div>
      </div>

      <!-- Ergebnisse -->
      <div id="game-result" class="hidden"></div>

      <!-- Nächste Runde Button (für Host nach Spielende, Online) -->
      <button id="nextRound" class="hidden" style="margin-top:20px">🔄 Nächste Runde starten</button>
    </div>
  </div>

  <!-- Countdown Overlay -->
  <div id="countdown" class="countdown hidden"></div>

  <!-- Secret Reveal Overlay -->
  <div id="secretReveal" class="secret-reveal">
    <h2 id="secretRole">Deine Rolle</h2>
    <div class="secret-word" id="secretWord">Wort</div>
    <p id="secretNote"></p>
    <div class="hold-instruction">Halte weiter gedrückt...</div>
  </div>

  <!-- Bestätigungsdialog -->
  <div id="confirmationDialog" class="confirmation-dialog hidden">
    <div class="confirmation-content">
      <h3 style="color:#dc3545; margin-bottom:15px;">⚠️ Spiel verlassen?</h3>
      <p style="margin-bottom:20px; line-height:1.5;">
        Bist du sicher, dass du das Spiel verlassen möchtest?<br>Du kannst später nicht mehr beitreten!
      </p>
      <div class="confirmation-buttons">
        <button class="danger" onclick="confirmLeave()">Ja, verlassen</button>
        <button class="secondary" onclick="hideConfirmation()">Abbrechen</button>
      </div>
    </div>
  </div>

  <div class="footer">Imposter Wortspiel © 2024</div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/client.js"></script>
</body>
</html>
